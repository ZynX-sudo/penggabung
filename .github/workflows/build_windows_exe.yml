name: Build Windows Executable

on:
  push:
    branches:
      - main # Jalankan workflow setiap kali ada push ke branch 'main'
  workflow_dispatch: # Izinkan menjalankan workflow secara manual dari GitHub UI

jobs:
  build:
    runs-on: windows-latest # Gunakan runner Windows terbaru dari GitHub

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4 # Mengunduh kode (termasuk PDFTK.exe) dari repositori Anda

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10' # Pastikan ini konsisten dengan versi yang Anda inginkan

      - name: Install dependencies
        run: |
          # Pastikan pip terupdate
          python -m pip install --upgrade pip
          # Instal semua dependensi dari requirements.txt
          pip install -r requirements.txt
          # Instal pyinstaller secara eksplisit.
          # Menambahkan --break-system-packages (untuk Python 3.11+) atau --user (untuk Python lama)
          # bisa membantu jika ada masalah izin di lingkungan runner, tapi umumnya tidak perlu.
          pip install pyinstaller

      # Bagian ini dihapus karena PDFTK.exe sudah di repositori.

      - name: Build executable with PyInstaller
        # Pastikan PyInstaller dipanggil dengan `python -m` untuk menghindari masalah PATH
        run: |
          python -m pyinstaller --noconsole --onefile --windowed --add-binary "PDFTK.exe;." --name "PDFMergeTool" penggabung.py

      - name: Upload artifact
        uses: actions/upload-artifact@v4
        with:
          name: PDFMergeTool-Windows-Executables
          path: dist/PDFMergeTool.exe # Lokasi file .exe yang dihasilkan
